import{c as h,r as a,j as e,m as b,A as B,Z as V,b as G,d as J,L as K}from"./index-X1niyO1E.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=h("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=h("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=h("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=h("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]),se=({lesson:l,viewPreferences:i={},onZoomChange:s})=>{var M,_,S,I;const[c,u]=a.useState(i.zoom||1),[z,k]=a.useState(0),[r,p]=a.useState({x:0,y:0}),[x,y]=a.useState(!1),[w,v]=a.useState(!1),[E,f]=a.useState(!0),[R,g]=a.useState(!1),N=a.useRef(null),o=a.useRef({x:0,y:0}),d=l.contentUrl||((M=l.source)==null?void 0:M.url)||l.fileUrl||l.imageUrl,D=a.useCallback(()=>{u(t=>{const n=Math.min(t+.25,3);return s==null||s(n),n})},[s]),T=a.useCallback(()=>{u(t=>{const n=Math.max(t-.25,.5);return s==null||s(n),n})},[s]),F=a.useCallback(()=>{u(1),p({x:0,y:0}),k(0),s==null||s(1)},[s]),U=a.useCallback(()=>{k(t=>(t+90)%360)},[]),Y=a.useCallback(()=>{var t;document.fullscreenElement?(document.exitFullscreen(),v(!1)):((t=N.current)==null||t.requestFullscreen(),v(!0))},[]),$=a.useCallback(t=>{c>1&&(y(!0),o.current={x:t.clientX-r.x,y:t.clientY-r.y})},[c,r]),A=a.useCallback(t=>{x&&p({x:t.clientX-o.current.x,y:t.clientY-o.current.y})},[x]),j=a.useCallback(()=>{y(!1)},[]),O=a.useCallback(t=>{if(c>1&&t.touches.length===1){const n=t.touches[0];y(!0),o.current={x:n.clientX-r.x,y:n.clientY-r.y}}},[c,r]),X=a.useCallback(t=>{if(x&&t.touches.length===1){const n=t.touches[0];p({x:n.clientX-o.current.x,y:n.clientY-o.current.y})}},[x]),q=a.useCallback(t=>{t.preventDefault();const n=t.deltaY>0?-.1:.1;u(W=>{const L=Math.max(.5,Math.min(3,W+n));return s==null||s(L),L})},[s]),H=a.useCallback(()=>{f(!1),g(!1)},[]),C=a.useCallback(()=>{f(!1),g(!0)},[]),P=a.useCallback(()=>{if(d){const t=document.createElement("a");t.href=d,t.download=l.title||"lesson-image",t.click()}},[d,l.title]);return R?e.jsx("div",{className:"flex-1 flex items-center justify-center p-8 bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx(b.div,{initial:{scale:0},animate:{scale:1},className:"w-20 h-20 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(B,{className:"w-10 h-10 text-red-500"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-700 mb-2 font-comic",children:"Oops! Image couldn't load"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"The image might be missing or broken."}),e.jsx("button",{onClick:()=>{g(!1),f(!0)},className:"px-4 py-2 bg-nanobanana-blue text-white font-bold rounded-xl border-2 border-black shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] hover:shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] transition-shadow",children:"Try Again"})]})}):e.jsxs("div",{ref:N,className:"flex flex-col h-full bg-gray-100",onMouseUp:j,onMouseLeave:j,onTouchEnd:j,children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-white border-b-4 border-black",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{onClick:T,disabled:c<=.5,icon:e.jsx(V,{className:"w-5 h-5"}),label:"Zoom Out"}),e.jsxs("div",{className:"px-3 py-1 bg-gray-100 rounded-full font-bold text-sm min-w-[60px] text-center",children:[Math.round(c*100),"%"]}),e.jsx(m,{onClick:D,disabled:c>=3,icon:e.jsx(G,{className:"w-5 h-5"}),label:"Zoom In"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{onClick:U,icon:e.jsx(te,{className:"w-5 h-5"}),label:"Rotate"}),e.jsx(m,{onClick:Y,icon:w?e.jsx(ee,{className:"w-5 h-5"}):e.jsx(Z,{className:"w-5 h-5"}),label:w?"Exit Fullscreen":"Fullscreen"}),e.jsx("button",{onClick:F,className:"px-3 py-2 bg-nanobanana-yellow text-black font-bold text-sm rounded-xl border-2 border-black hover:shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] transition-all",children:"Reset"})]})]}),e.jsxs("div",{className:"flex-1 overflow-hidden flex items-center justify-center p-4 cursor-grab active:cursor-grabbing",onMouseDown:$,onMouseMove:A,onTouchStart:O,onTouchMove:X,onWheel:q,children:[e.jsx(J,{children:E&&e.jsx(b.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 flex items-center justify-center bg-gray-100 z-10",children:e.jsxs("div",{className:"text-center",children:[e.jsx(K,{className:"w-12 h-12 animate-spin text-nanobanana-blue mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 font-comic",children:"Loading image..."})]})})}),d&&e.jsx(b.img,{src:d,alt:l.title||"Lesson image",className:"max-w-full max-h-full object-contain rounded-lg shadow-lg select-none",style:{transform:`translate(${r.x}px, ${r.y}px) scale(${c}) rotate(${z}deg)`,transition:x?"none":"transform 0.2s ease-out"},onLoad:H,onError:C,draggable:!1})]}),e.jsxs("div",{className:"px-4 py-2 bg-white border-t-2 border-gray-200 flex items-center justify-between text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium truncate max-w-[200px]",children:((_=l.fileMetadata)==null?void 0:_.originalFileName)||((S=l.source)==null?void 0:S.originalName)||l.title||"Image"}),((I=l.fileMetadata)==null?void 0:I.dimensions)&&e.jsxs("span",{children:[l.fileMetadata.dimensions.width," x ",l.fileMetadata.dimensions.height]}),e.jsxs("button",{onClick:P,className:"flex items-center gap-1 text-nanobanana-blue hover:underline",children:[e.jsx(Q,{className:"w-4 h-4"}),"Download"]})]})]})},m=({onClick:l,disabled:i,icon:s,label:c})=>e.jsx(b.button,{whileHover:{scale:i?1:1.05},whileTap:{scale:i?1:.95},onClick:l,disabled:i,className:`
      p-2 rounded-xl border-2 border-black
      ${i?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-white hover:bg-gray-50 shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] hover:shadow-[3px_3px_0px_0px_rgba(0,0,0,1)]"}
      transition-all
    `,title:c,children:s});export{se as default};
